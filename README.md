# Shaggy (schedule generator)

## Описание
Shaggy - генератор расписания. Для генерации используется шаблон в виде "числа месяца"/"сотрудники"
На данной итерации он поддерживает только базу данных в виде листа "Сотрудники" из целевого excel файла.

## Инструкция
Для удобства приведу пример своего опыта использования Shaggy:

> **Warning**
> Целевой эксель файл НЕ должен быть открытым во время работы скрипта

1. В директории home ```~``` создайте папку, где будет хранится файл с расписанием

```
mkdir ~/projectFolder
```
2. Для удобства в ту же папку поместите бинарный файл со скриптом. В данном примере он будет называться ```shaggy```
3. Первый запуск скрипта рекомендутся делать вручную.
Он принимает единственный аргумент - путь до целевого excel файла с расписанием ```targetfile.xlsx```,
в котором уже создан лист с базой данных сотрудников. Шаблон листа будет в конце README.

Зайдите в папку и запустите скрипт:
```
cd ~/projectFolder && ./shaggy ./targetfile.xlsx
```

Опционально, третьим параметром можно передать *date offset*, месячный отступ. Таким образом команда запущенная 01.2023, сгенерирует расписание на 3й месяц от текущего, то есть на 04.2023
```
cd ~/projectFolder && ./shaggy ./targetfile.xlsx 3
```

После этого в целевом файле должно сгенерироваться расписание, а в папке с проектом появиться папка с логами.

```
├── logs
│   ├── log-yyyy-month-dd_hh:mm:ss.txt
├── shaggy
└── targetfile.xlsx
```

## Советы

Для удобства можно добавить shaggy в PATH, чтобы вызывать его из любой директории

```
export PATH=$PATH:~/path/to/shaggy
```
Также можно поставить автозапуск скрипта через ```crontab```

## Шаблон таблицы с сотрудниками для Excel
| Name           | Birthday   | StartTime | EndTime  | Job                                                             | PhoneNumber | Weekend |
| -------------- | ---------- | --------- | -------- | --------------------------------------------------------------- | ----------- | ------- |
| Иванов И.И.   | 02.01.2006 | 09:00:00  | 18:00:00 | Рядовой сотрудник                                                 | 88005553555 | 56      |

### Примечания
1. Birthday должен быть в формате "Краткий форматы даты"
2. Start и End time должны быть в формате "Время"
3. Weekend указываются в виде чисел от 0 до 6, обозначающих день недели: 0 - воскресенье
